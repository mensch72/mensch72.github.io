"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8592],{2122:(Q,Z,i)=>{i.r(Z),i.d(Z,{AddoptionDialogPage:()=>c,AddoptionDialogPageModule:()=>U});var m=i(6362),u=i(587),t=i(8139),l=i(3926),f=i(1951),o=i(5568),a=i(2340),r=i(8211),e=i(260),n=i(6301);const b=["focus_element"],_=function(g){return{language:g}};function D(g,C){if(1&g&&(e.TgZ(0,"small"),e._UZ(1,"p",5),e.ALo(2,"translate"),e.qZA()),2&g){const p=e.oxw(2);e.xp6(1),e.Q6J("innerHtml",e.xi3(2,1,"addoption.different-language",e.VKq(4,_,p.G.S.language_names[p.p.language])),e.oJD)}}function v(g,C){if(1&g&&(e._UZ(0,"div",21),e.ALo(1,"translate")),2&g){const p=e.oxw().$implicit;e.Q6J("innerHtml",e.lcZ(1,1,p.message),e.oJD)}}function y(g,C){if(1&g&&(e.ynx(0),e.YNc(1,v,2,3,"div",20),e.BQk()),2&g){const p=C.$implicit,J=e.oxw(2);e.xp6(1),e.Q6J("ngIf",J.formGroup.get("option_name").hasError(p.type)&&(J.formGroup.get("option_name").dirty||J.formGroup.get("option_name").touched))}}function T(g,C){if(1&g&&(e._UZ(0,"div",21),e.ALo(1,"translate")),2&g){const p=e.oxw().$implicit;e.Q6J("innerHtml",e.lcZ(1,1,p.message),e.oJD)}}function G(g,C){if(1&g&&(e.ynx(0),e.YNc(1,T,2,3,"div",20),e.BQk()),2&g){const p=C.$implicit,J=e.oxw(2);e.xp6(1),e.Q6J("ngIf",J.formGroup.get("option_desc").hasError(p.type)&&(J.formGroup.get("option_desc").dirty||J.formGroup.get("option_desc").touched))}}function h(g,C){if(1&g){const p=e.EpF();e.TgZ(0,"ion-button",22),e.NdJ("click",function(){e.CHM(p);const S=e.oxw(2);return S.G.open_url_in_new_tab(S.formGroup.get("option_url").value)}),e._UZ(1,"span",5),e.ALo(2,"translate"),e._uU(3,"\xa0 "),e._UZ(4,"ion-icon",23),e.qZA()}2&g&&(e.xp6(1),e.Q6J("innerHtml",e.lcZ(2,1,"test"),e.oJD))}function A(g,C){if(1&g&&(e._UZ(0,"div",21),e.ALo(1,"translate")),2&g){const p=e.oxw().$implicit;e.Q6J("innerHtml",e.lcZ(1,1,p.message),e.oJD)}}function s(g,C){if(1&g&&(e.ynx(0),e.YNc(1,A,2,3,"div",20),e.BQk()),2&g){const p=C.$implicit,J=e.oxw(2);e.xp6(1),e.Q6J("ngIf",J.formGroup.get("option_url").hasError(p.type)&&(J.formGroup.get("option_url").dirty||J.formGroup.get("option_url").touched))}}const x=function(g){return{name:g}},d=function(){return[null,""]};function w(g,C){if(1&g){const p=e.EpF();e.TgZ(0,"ion-content")(1,"form",1)(2,"ion-list",2)(3,"ion-item",3)(4,"ion-col",4),e._UZ(5,"h1",5),e.ALo(6,"translate"),e._UZ(7,"p",5),e.ALo(8,"translate"),e.YNc(9,D,3,6,"small",0),e.qZA()(),e.TgZ(10,"ion-item")(11,"ion-label",6),e._UZ(12,"span",5),e.ALo(13,"translate"),e.qZA(),e._UZ(14,"ion-input",7,8),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",9),e.YNc(18,y,2,1,"ng-container",10),e.qZA(),e.TgZ(19,"ion-item")(20,"ion-label",6),e._UZ(21,"span",5),e.ALo(22,"translate"),e.qZA(),e._UZ(23,"ion-textarea",11),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div",9),e.YNc(26,G,2,1,"ng-container",10),e.qZA(),e.TgZ(27,"ion-item")(28,"ion-label",6),e._UZ(29,"span",5),e.ALo(30,"translate"),e.qZA(),e._UZ(31,"ion-input",12),e.ALo(32,"translate"),e.YNc(33,h,5,3,"ion-button",13),e.qZA(),e.TgZ(34,"div",9),e.YNc(35,s,2,1,"ng-container",10),e.qZA(),e.TgZ(36,"ion-item",14)(37,"ion-buttons",15)(38,"ion-button",16),e.NdJ("click",function(){return e.CHM(p),e.oxw().ClosePopover()}),e._UZ(39,"ion-icon",17),e._uU(40,"\xa0 "),e._UZ(41,"span",5),e.ALo(42,"translate"),e.qZA(),e._uU(43,"\xa0\xa0 "),e.TgZ(44,"ion-button",18),e.NdJ("click",function(){return e.CHM(p),e.oxw().OK_button_clicked()}),e._UZ(45,"ion-icon",19),e._uU(46,"\xa0 "),e._UZ(47,"span",5),e.ALo(48,"translate"),e.qZA()()(),e.TgZ(49,"ion-item",3),e._UZ(50,"small",5),e.ALo(51,"translate"),e.qZA()()()()}if(2&g){const p=e.oxw();e.xp6(1),e.Q6J("formGroup",p.formGroup),e.xp6(4),e.Q6J("innerHtml",e.lcZ(6,20,"addoption.header"),e.oJD),e.xp6(2),e.Q6J("innerHtml",e.lcZ(8,22,"addoption.intro"),e.oJD),e.xp6(2),e.Q6J("ngIf",!!p.p.language&&p.p.language!=p.G.S.language),e.xp6(3),e.Q6J("innerHtml",e.lcZ(13,24,"winner"==p.p.type?"draftpoll.option-name-label":"draftpoll.target-name-label"),e.oJD),e.xp6(2),e.Q6J("placeholder",e.lcZ(16,26,"winner"==p.p.type?"draftpoll.option-name-placeholder":"draftpoll.target-name-placeholder"))("maxlength",p.E.max_len.name),e.xp6(4),e.Q6J("ngForOf",p.validation_messages.option_name),e.xp6(3),e.Q6J("innerHtml",e.lcZ(22,28,"draftpoll.option-desc-label"),e.oJD),e.xp6(2),e.Q6J("maxlength",p.E.max_len.desc)("placeholder",e.xi3(24,30,"draftpoll.option-desc-placeholder",e.VKq(44,x,p.formGroup.get("option_name").value))),e.xp6(3),e.Q6J("ngForOf",p.validation_messages.option_desc),e.xp6(3),e.Q6J("innerHtml",e.lcZ(30,33,"draftpoll.option-url-label"),e.oJD),e.xp6(2),e.Q6J("placeholder",e.xi3(32,35,"draftpoll.option-url-placeholder",e.VKq(46,x,p.formGroup.get("option_name").value)))("maxlength",p.E.max_len.url),e.xp6(2),e.Q6J("ngIf",p.formGroup.get("option_url").valid&&!e.DdM(48,d).includes(p.formGroup.get("option_url").value)),e.xp6(2),e.Q6J("ngForOf",p.validation_messages.option_url),e.xp6(6),e.Q6J("innerHtml",e.lcZ(42,38,"cancel"),e.oJD),e.xp6(6),e.Q6J("innerHtml",e.lcZ(48,40,"add"),e.oJD),e.xp6(3),e.Q6J("innerHtml",e.lcZ(51,42,"addoption.info"),e.oJD)}}let c=(()=>{class g{constructor(p,J,S,M,L){this.formBuilder=p,this.popover=J,this.G=S,this.translate=M,this.ref=L,this.E=a.N,this.ready=!1,this.validation_messages={option_name:[{type:"required",message:"validation.option-name-required"}],option_desc:[],option_url:[{type:"pattern",message:"validation.option-url-valid"}]}}ngOnInit(){}ionViewWillEnter(){this.p=this.parent.p,this.formGroup=this.formBuilder.group({}),this.formGroup.addControl("option_name",new u.NI("",u.kI.required)),this.formGroup.addControl("option_desc",new u.NI("")),this.formGroup.addControl("option_url",new u.NI("",u.kI.pattern(this.G.urlRegex))),this.ready=!0}ionViewDidEnter(){setTimeout(()=>this.focus_element.setFocus(),100)}OK_button_clicked(){const p=this.formGroup.get("option_name").value,J=this.formGroup.get("option_desc").value,S=this.formGroup.get("option_url").value,M=new r.Wx(this.G,this.p,null,p,J,S);o.s.schedule({notifications:[{title:this.translate.instant("addoption.notification-added-title"),body:p,id:0}]}).then(L=>{}).catch(L=>{}),"agreed"==this.parent.delegation_status&&this.G.Del.update_my_delegation(this.p.pid,M.oid,!0),this.parent.oidsorted.push(M.oid),this.parent.sortingcounter++,this.ref.detectChanges(),setTimeout(()=>{this.p.tally_all(),this.popover.dismiss()},200)}ClosePopover(){this.popover.dismiss()}}return g.\u0275fac=function(p){return new(p||g)(e.Y36(u.qu),e.Y36(l.Dh),e.Y36(n.U),e.Y36(t.sK),e.Y36(e.sBO))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-addoption-dialog"]],viewQuery:function(p,J){if(1&p&&e.Gf(b,5),2&p){let S;e.iGM(S=e.CRH())&&(J.focus_element=S.first)}},inputs:{parent:"parent"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"formGroup"],["lines","full"],["lines","none"],[1,"ion-no-padding","ion-no-margin"],[3,"innerHtml"],["position","floating","color","primary"],["formControlName","option_name","autofocus","true","type","text","required","",2,"font-weight","bold","font-style","italic",3,"placeholder","maxlength"],["focus_element",""],[1,"validation-errors"],[4,"ngFor","ngForOf"],["formControlName","option_desc","rows","1","auto-grow","","type","text",2,"font-style","italic",3,"maxlength","placeholder"],["formControlName","option_url","type","text","inputmode","url",2,"font-size","smaller",3,"placeholder","maxlength"],["fill","clear","slot","end","class","skip-button","tabindex","-1",3,"click",4,"ngIf"],["lines","none",1,"ion-text-right"],["slot","end"],["shape","round",3,"click"],["name","arrow-back-outline"],["color","primary","shape","round","fill","solid",3,"click"],["name","checkmark"],["class","error-message",3,"innerHtml",4,"ngIf"],[1,"error-message",3,"innerHtml"],["fill","clear","slot","end","tabindex","-1",1,"skip-button",3,"click"],["name","open-outline"]],template:function(p,J){1&p&&e.YNc(0,w,52,49,"ion-content",0),2&p&&e.Q6J("ngIf",J.ready)},directives:[m.O5,l.W2,u._Y,u.JL,u.sg,l.q_,l.Ie,l.wI,l.Q$,l.pK,l.j9,u.JJ,u.u,u.Q7,u.nD,m.sg,l.g2,l.YG,l.gu,l.Sm],pipes:[t.X$],styles:['@charset "UTF-8";']}),g})();const P=[{path:"",component:c}];let E=(()=>{class g{}return g.\u0275fac=function(p){return new(p||g)},g.\u0275mod=e.oAB({type:g}),g.\u0275inj=e.cJS({imports:[[f.Bz.forChild(P)],f.Bz]}),g})(),U=(()=>{class g{}return g.\u0275fac=function(p){return new(p||g)},g.\u0275mod=e.oAB({type:g}),g.\u0275inj=e.cJS({imports:[[m.ez,u.u5,l.Pc,u.UX,E,t.aw.forChild()]]}),g})()},2459:(Q,Z,i)=>{i.r(Z),i.d(Z,{DelegationDialogPage:()=>h,DelegationDialogPageModule:()=>x});var m=i(6362),u=i(587),t=i(8139),l=i(3926),f=i(1951),o=i(5099),a=i(8921),r=i(5568),e=i(2340),n=i(260),b=i(6301);const _=["focus_element"];function D(d,w){if(1&d&&(n._UZ(0,"div",18),n.ALo(1,"translate")),2&d){const c=n.oxw().$implicit;n.Q6J("innerHtml",n.lcZ(1,1,c.message),n.oJD)}}function v(d,w){if(1&d&&(n.ynx(0),n.YNc(1,D,2,3,"div",17),n.BQk()),2&d){const c=w.$implicit,P=n.oxw(2);n.xp6(1),n.Q6J("ngIf",P.formGroup.get("delegate_nickname").hasError(c.type)&&(P.formGroup.get("delegate_nickname").dirty||P.formGroup.get("delegate_nickname").touched))}}function y(d,w){if(1&d){const c=n.EpF();n.ynx(0),n.TgZ(1,"ion-item",3)(2,"ion-col",4)(3,"small"),n._UZ(4,"p",5),n.ALo(5,"translate"),n.qZA()()(),n.TgZ(6,"ion-item",12)(7,"ion-button",13),n.NdJ("click",function(){return n.CHM(c),n.oxw(2).share_button_clicked()}),n._UZ(8,"span",5),n.ALo(9,"translate"),n._uU(10,"\xa0 "),n._UZ(11,"ion-icon",19),n.qZA()(),n.BQk()}if(2&d){const c=n.oxw(2);n.xp6(4),n.Q6J("innerHtml",n.lcZ(5,3,"delegation-request.request-options-with-share"),n.oJD),n.xp6(3),n.Q6J("disabled",!c.formGroup.valid),n.xp6(1),n.Q6J("innerHtml",n.lcZ(9,5,"inviteto.share"),n.oJD)}}function T(d,w){1&d&&(n.ynx(0),n.TgZ(1,"ion-item",3)(2,"ion-col",4)(3,"small"),n._UZ(4,"p",5),n.ALo(5,"translate"),n.qZA()()(),n.BQk()),2&d&&(n.xp6(4),n.Q6J("innerHtml",n.lcZ(5,1,"delegation-request.request-options-without-share"),n.oJD))}function G(d,w){if(1&d){const c=n.EpF();n.TgZ(0,"ion-content")(1,"form",1)(2,"ion-list",2)(3,"ion-item",3)(4,"ion-col",4),n._UZ(5,"h1",5),n.ALo(6,"translate"),n._UZ(7,"p",5),n.ALo(8,"translate"),n.qZA()(),n.TgZ(9,"ion-item"),n._UZ(10,"ion-label",6),n.ALo(11,"translate"),n.TgZ(12,"ion-input",7,8),n.NdJ("ionChange",function(){return n.CHM(c),n.oxw().delegate_nickname_changed()})("ionBlur",function(){return n.CHM(c),n.oxw().delegate_nickname_changed()}),n.ALo(14,"translate"),n.qZA()(),n.TgZ(15,"div",9),n.YNc(16,v,2,1,"ng-container",10),n.qZA(),n.TgZ(17,"ion-item")(18,"small"),n._UZ(19,"ion-label",6),n.ALo(20,"translate"),n.TgZ(21,"ion-input",11),n.NdJ("ionChange",function(){return n.CHM(c),n.oxw().from_changed()})("ionBlur",function(){return n.CHM(c),n.oxw().from_changed()}),n.ALo(22,"translate"),n.qZA()()(),n.YNc(23,y,12,7,"ng-container",0),n.YNc(24,T,6,3,"ng-container",0),n.TgZ(25,"ion-item",12)(26,"ion-button",13),n.NdJ("click",function(E){return n.CHM(c),n.oxw().email_button_clicked(E)}),n.TgZ(27,"a",14),n._UZ(28,"span",5),n.ALo(29,"translate"),n._uU(30,"\xa0 "),n._UZ(31,"ion-icon",15),n.qZA()()(),n.TgZ(32,"ion-item",12)(33,"ion-button",13),n.NdJ("click",function(){return n.CHM(c),n.oxw().copy_button_clicked()}),n._UZ(34,"span",5),n.ALo(35,"translate"),n._uU(36,"\xa0 "),n._UZ(37,"ion-icon",16),n.qZA()()()()()}if(2&d){const c=n.oxw();n.xp6(1),n.Q6J("formGroup",c.formGroup),n.xp6(4),n.Q6J("innerHtml",n.lcZ(6,17,"delegation-request.header"),n.oJD),n.xp6(2),n.Q6J("innerHtml",n.lcZ(8,19,"delegation-request.intro"),n.oJD),n.xp6(3),n.Q6J("innerHtml",n.lcZ(11,21,"delegation-request.nickname-label"),n.oJD),n.xp6(2),n.Q6J("placeholder",n.lcZ(14,23,"delegation-request.nickname-placeholder"))("maxlength",c.E.max_len.name),n.xp6(4),n.Q6J("ngForOf",c.validation_messages.delegate_nickname),n.xp6(3),n.Q6J("innerHtml",n.lcZ(20,25,"delegation-request.from-label"),n.oJD),n.xp6(2),n.Q6J("placeholder",n.lcZ(22,27,"delegation-request.from-placeholder"))("maxlength",c.E.max_len.name),n.xp6(2),n.Q6J("ngIf",c.can_share),n.xp6(1),n.Q6J("ngIf",!c.can_share),n.xp6(2),n.Q6J("disabled",!c.formGroup.valid),n.xp6(1),n.Q6J("href",c.mailto_url,n.LSH),n.xp6(1),n.Q6J("innerHtml",n.lcZ(29,29,"delegation-request.compose-email"),n.oJD),n.xp6(5),n.Q6J("disabled",!c.formGroup.valid),n.xp6(1),n.Q6J("innerHtml",n.lcZ(35,31,"delegation-request.copy-link"),n.oJD)}}let h=(()=>{class d{constructor(c,P,E,U){this.popover=c,this.formBuilder=P,this.translate=E,this.G=U,this.E=e.N,this.ready=!1,this.validation_messages={delegate_nickname:[{type:"required",message:"validation.delegate-nickname-required"}],from:[]}}ngOnInit(){}ionViewWillEnter(){this.can_use_web_share="function"==typeof navigator.share,this.can_share=o.dV.isNativePlatform()||this.can_use_web_share,this.formGroup=this.formBuilder.group({delegate_nickname:new u.NI("",u.kI.required),from:new u.NI(this.G.S.email)}),[this.p,this.did,this.request,this.private_key,this.agreement]=this.G.Del.prepare_delegation(this.parent.pid),this.message_title=this.translate.instant("delegation-request.message-subject",{due:this.G.D.format_date(this.p.due)}),this.update_request(),this.ready=!0}ionViewDidEnter(){setTimeout(()=>this.focus_element.setFocus(),100)}delegate_nickname_changed(){const c=this.formGroup.get("delegate_nickname").value;this.G.D.setp(this.p.pid,"del_nickname."+this.did,c),this.update_request()}from_changed(){const c=this.formGroup.get("from").value;this.G.D.setp(this.p.pid,"del_from."+this.did,c),this.set_delegation_link(c),this.update_request()}update_request(){this.G.L.entry("DelegationDialogPage.update_request"),this.mailto_url="mailto:"+encodeURIComponent(this.formGroup.get("delegate_nickname").value)+"?subject="+encodeURIComponent(this.message_title)+"&body="+encodeURIComponent(this.message_body)}ClosePopover(){this.popover.dismiss()}set_delegation_link(c){this.delegation_link=this.G.Del.get_delegation_link(this.parent.pid,this.did,c,this.private_key),this.message_body=this.translate.instant("delegation-request.message-body-greeting")+"\n\n"+this.translate.instant("delegation-request.message-body-before-title")+"\n\n"+String.fromCharCode(160).repeat(4)+this.p.title+".\n\n"+this.translate.instant("delegation-request.message-body-closes",{due:this.G.D.format_date(this.p.due)})+"\n\n"+this.translate.instant("delegation-request.message-body-explanation")+"\n\n"+this.translate.instant("delegation-request.message-body-before-link")+"\n\n"+String.fromCharCode(160).repeat(4)+this.delegation_link+"\n\n"+this.translate.instant("delegation-request.message-body-dont-share")+"\n\n"+this.translate.instant("delegation-request.message-body-regards")}share_button_clicked(){this.G.L.entry("DelegationDialogPage.share_button_clicked"),this.delegate_nickname_changed(),this.from_changed(),a.m.share({title:this.message_title,text:this.message_body,dialogTitle:"Share vodle delegation link"}).then(c=>{this.G.L.info("DelegationDialogPage.share_button_clicked succeeded",c),this.G.Del.after_request_was_sent(this.parent.pid,this.did,this.request,this.private_key,this.agreement),this.popover.dismiss()}).catch(c=>{this.G.L.error("DelegationDialogPage.share_button_clicked failed",c)})}copy_button_clicked(){this.G.L.entry("DelegationDialogPage.copy_button_clicked"),this.delegate_nickname_changed(),this.from_changed(),window.navigator.clipboard.writeText(this.delegation_link),this.G.Del.after_request_was_sent(this.parent.pid,this.did,this.request,this.private_key,this.agreement),r.s.schedule({notifications:[{title:this.translate.instant("delegation-request.notification-copied-link-title"),body:this.translate.instant("delegation-request.notification-copied-link-body",{nickname:this.formGroup.get("delegate_nickname").value}),id:null}]}).then(c=>{this.G.L.trace("DelegationDialogPage.copy_button_clicked localNotifications.schedule succeeded:",c)}).catch(c=>{this.G.L.warn("DelegationDialogPage.copy_button_clicked localNotifications.schedule failed:",c)}),this.parent.update_delegation_info(),this.popover.dismiss(),this.G.L.exit("DelegationDialogPage.copy_button_clicked")}email_button_clicked(c){this.G.L.entry("DelegationDialogPage.email_button_clicked"),this.delegate_nickname_changed(),this.from_changed(),this.G.Del.after_request_was_sent(this.parent.pid,this.did,this.request,this.private_key,this.agreement),this.parent.update_delegation_info(),this.popover.dismiss(),this.G.L.exit("DelegationDialogPage.email_button_clicked")}}return d.\u0275fac=function(c){return new(c||d)(n.Y36(l.Dh),n.Y36(u.qu),n.Y36(t.sK),n.Y36(b.U))},d.\u0275cmp=n.Xpm({type:d,selectors:[["app-delegation-dialog"]],viewQuery:function(c,P){if(1&c&&n.Gf(_,5),2&c){let E;n.iGM(E=n.CRH())&&(P.focus_element=E.first)}},inputs:{parent:"parent"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"formGroup"],["lines","full"],["lines","none"],[1,"ion-no-padding","ion-no-margin"],[3,"innerHtml"],["position","floating","color","primary",3,"innerHtml"],["formControlName","delegate_nickname","autofocus","true","debounce","100","type","text",3,"placeholder","maxlength","ionChange","ionBlur"],["focus_element",""],[1,"validation-errors"],[4,"ngFor","ngForOf"],["formControlName","from","debounce","100","type","text",3,"placeholder","maxlength","ionChange","ionBlur"],["lines","none","text-wrap","",1,"ion-text-end"],["color","primary","slot","end","shape","round",3,"disabled","click"],["target","_top",2,"color","inherit","text-decoration","inherit",3,"href"],["name","mail-open-outline"],["name","copy-outline"],["class","error-message",3,"innerHtml",4,"ngIf"],[1,"error-message",3,"innerHtml"],["name","share-social-outline"]],template:function(c,P){1&c&&n.YNc(0,G,38,33,"ion-content",0),2&c&&n.Q6J("ngIf",P.ready)},directives:[m.O5,l.W2,u._Y,u.JL,u.sg,l.q_,l.Ie,l.wI,l.Q$,l.pK,l.j9,u.JJ,u.u,u.nD,m.sg,l.YG,l.gu],pipes:[t.X$],styles:['@charset "UTF-8";']}),d})();const A=[{path:"",component:h}];let s=(()=>{class d{}return d.\u0275fac=function(c){return new(c||d)},d.\u0275mod=n.oAB({type:d}),d.\u0275inj=n.cJS({imports:[[f.Bz.forChild(A)],f.Bz]}),d})(),x=(()=>{class d{}return d.\u0275fac=function(c){return new(c||d)},d.\u0275mod=n.oAB({type:d}),d.\u0275inj=n.cJS({imports:[[m.ez,u.u5,l.Pc,u.UX,s,t.aw.forChild()]]}),d})()},3357:(Q,Z,i)=>{i.r(Z),i.d(Z,{DraftpollKebapPage:()=>r,DraftpollKebapPageModule:()=>b});var m=i(6362),u=i(587),t=i(8139),l=i(3926),f=i(1951),o=i(260);function a(_,D){if(1&_&&o._UZ(0,"ion-select-option",10),2&_){const v=D.$implicit,y=o.oxw();o.Q6J("value",v)("innerHtml",y.JSON.parse(v).title,o.oJD)}}let r=(()=>{class _{constructor(v,y){this.popover=v,this.ref=y,this.JSON=JSON,this.examples=[]}ngOnInit(){}ionViewWillEnter(){}ClosePopover(){this.popover.dismiss()}send4review(){this.parent.send4review(),this.popover.dismiss()}import(){this.parent.import_csv_dialog(),this.popover.dismiss()}use_example_clicked(){this.parent.G.D.get_example_docs().then(v=>{this.examples=[];for(let y of v.rows){let T=y.doc;T._id.includes("\xa7\xa7")||this.examples.push(JSON.stringify(T))}this.ref.detectChanges(),this.select_example.open(new MouseEvent("click"))}).catch(v=>{this.parent.G.L.error("DraftpollPage.use_example_clicked failed",v)})}use_example(){var v=this.select_example.value;"-"!=(v||"-")&&(this.parent.restart_with_data(v),this.popover.dismiss())}}return _.\u0275fac=function(v){return new(v||_)(o.Y36(l.Dh),o.Y36(o.sBO))},_.\u0275cmp=o.Xpm({type:_,selectors:[["app-draftpoll-kebap"]],viewQuery:function(v,y){if(1&v&&o.Gf(l.t9,5),2&v){let T;o.iGM(T=o.CRH())&&(y.select_example=T.first)}},inputs:{parent:"parent"},decls:27,vars:19,consts:[[3,"click"],["fill","clear","color","dark"],["name","share-social"],[3,"innerHtml"],["name","folder-open-outline"],["name","cloud-download-outline"],["interface","popover","display","none",2,"font-size","smaller",3,"cancelText","okText","ionChange"],["ionSelects","","select_example",""],["value","-",3,"innerHtml"],[3,"value","innerHtml",4,"ngFor","ngForOf"],[3,"value","innerHtml"]],template:function(v,y){1&v&&(o.TgZ(0,"ion-content")(1,"ion-item",0),o.NdJ("click",function(){return y.send4review()}),o.TgZ(2,"ion-button",1),o._UZ(3,"ion-icon",2),o._uU(4,"\xa0\xa0"),o._UZ(5,"span",3),o.ALo(6,"translate"),o.qZA()(),o.TgZ(7,"ion-item",0),o.NdJ("click",function(){return y.import()}),o.TgZ(8,"ion-button",1),o._UZ(9,"ion-icon",4),o._uU(10,"\xa0\xa0"),o._UZ(11,"span",3),o.ALo(12,"translate"),o.qZA()(),o.TgZ(13,"ion-item",0),o.NdJ("click",function(){return y.use_example_clicked()}),o.TgZ(14,"ion-button",1),o._UZ(15,"ion-icon",5),o._uU(16,"\xa0\xa0 "),o._UZ(17,"span",3),o.ALo(18,"translate"),o.qZA(),o.TgZ(19,"ion-select",6,7),o.NdJ("ionChange",function(){return y.use_example()}),o.ALo(22,"translate"),o.ALo(23,"translate"),o._UZ(24,"ion-select-option",8),o.ALo(25,"translate"),o.YNc(26,a,1,2,"ion-select-option",9),o.qZA()()()),2&v&&(o.xp6(5),o.Q6J("innerHtml",o.lcZ(6,7,"draftpoll.send-for-review"),o.oJD),o.xp6(6),o.Q6J("innerHtml",o.lcZ(12,9,"draftpoll.import-options-from-file"),o.oJD),o.xp6(6),o.Q6J("innerHtml",o.lcZ(18,11,"draftpoll.use-example-from-db"),o.oJD),o.xp6(2),o.Q6J("cancelText",o.lcZ(22,13,"cancel"))("okText",o.lcZ(23,15,"OK")),o.xp6(5),o.Q6J("innerHtml",o.lcZ(25,17,"draftpoll.use-example-from-db-none"),o.oJD),o.xp6(2),o.Q6J("ngForOf",y.examples))},directives:[l.W2,l.Ie,l.YG,l.gu,l.t9,l.QI,l.n0,m.sg],pipes:[t.X$],styles:['@charset "UTF-8";']}),_})();const e=[{path:"",component:r}];let n=(()=>{class _{}return _.\u0275fac=function(v){return new(v||_)},_.\u0275mod=o.oAB({type:_}),_.\u0275inj=o.cJS({imports:[[f.Bz.forChild(e)],f.Bz]}),_})(),b=(()=>{class _{}return _.\u0275fac=function(v){return new(v||_)},_.\u0275mod=o.oAB({type:_}),_.\u0275inj=o.cJS({imports:[[m.ez,u.u5,l.Pc,n,t.aw.forChild()]]}),_})()},2767:(Q,Z,i)=>{i.d(Z,{K:()=>G});var m=i(587),u=i(2340),t=i(260),l=i(6301),f=i(3926),o=i(6362),a=i(8139);function r(h,A){1&h&&(t._UZ(0,"ion-select-option",8),t.ALo(1,"translate")),2&h&&t.Q6J("innerHtml",t.lcZ(1,1,"select-server.same-as-personal"),t.oJD)}function e(h,A){if(1&h&&t._UZ(0,"ion-select-option",12),2&h){const s=t.oxw().$implicit,x=t.oxw(2);t.Q6J("value",s)("innerHtml",x.G.P.polls[s].title,t.oJD)}}function n(h,A){if(1&h&&(t.ynx(0),t.YNc(1,e,1,2,"ion-select-option",11),t.BQk()),2&h){const s=A.$implicit,x=t.oxw(2);t.xp6(1),t.Q6J("ngIf",s!=x.page_object.p.pid)}}function b(h,A){if(1&h){const s=t.EpF();t.ynx(0),t.TgZ(1,"ion-item"),t._UZ(2,"ion-label",1),t.ALo(3,"translate"),t.TgZ(4,"ion-select",9),t.NdJ("ionChange",function(){return t.CHM(s),t.oxw().set_db_from_pid()}),t.ALo(5,"translate"),t.ALo(6,"translate"),t.YNc(7,n,2,1,"ng-container",10),t.qZA()(),t.BQk()}if(2&h){const s=t.oxw();t.xp6(2),t.Q6J("innerHtml",t.lcZ(3,4,"settings"==s.page?"select-server.which-poll":"select-server.which-other-poll"),t.oJD),t.xp6(2),t.Q6J("cancelText",t.lcZ(5,6,"cancel"))("okText",t.lcZ(6,8,"OK")),t.xp6(3),t.Q6J("ngForOf",s.Object.keys(s.G.P.polls))}}function _(h,A){if(1&h&&(t._UZ(0,"div",20),t.ALo(1,"translate")),2&h){const s=t.oxw().$implicit;t.Q6J("innerHtml",t.lcZ(1,1,s.message),t.oJD)}}function D(h,A){if(1&h&&(t.ynx(0),t.YNc(1,_,2,3,"div",19),t.BQk()),2&h){const s=A.$implicit,x=t.oxw(2);t.xp6(1),t.Q6J("ngIf",x.selectServerFormGroup.get("db_custom_server_url").hasError(s.type)&&(x.selectServerFormGroup.get("db_custom_server_url").dirty||x.selectServerFormGroup.get("db_custom_server_url").touched))}}function v(h,A){if(1&h&&(t._UZ(0,"div",20),t.ALo(1,"translate")),2&h){const s=t.oxw().$implicit;t.Q6J("innerHtml",t.lcZ(1,1,s.message),t.oJD)}}function y(h,A){if(1&h&&(t.ynx(0),t.YNc(1,v,2,3,"div",19),t.BQk()),2&h){const s=A.$implicit,x=t.oxw(2);t.xp6(1),t.Q6J("ngIf",x.selectServerFormGroup.get("db_custom_password").hasError(s.type)&&(x.selectServerFormGroup.get("db_custom_password").dirty||x.selectServerFormGroup.get("db_custom_password").touched))}}function T(h,A){if(1&h){const s=t.EpF();t.ynx(0),t.TgZ(1,"ion-item"),t._UZ(2,"small",13),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ion-item"),t._UZ(5,"ion-label",1),t.ALo(6,"translate"),t.TgZ(7,"ion-input",14),t.NdJ("ionChange",function(){return t.CHM(s),t.oxw().set_db_custom_server_url()}),t.qZA()(),t.TgZ(8,"div",15),t.YNc(9,D,2,1,"ng-container",10),t.qZA(),t.TgZ(10,"ion-item"),t._UZ(11,"ion-label",1),t.ALo(12,"translate"),t.TgZ(13,"ion-input",16),t.NdJ("keydown.enter",function(){t.CHM(s);const d=t.oxw();return d.showing_db_custom_password=!d.selectServerFormGroup.get("db_custom_password").valid&&d.showing_db_custom_password,d.blur()})("keydown.tab",function(){t.CHM(s);const d=t.oxw();return d.showing_db_custom_password=!d.selectServerFormGroup.get("db_custom_password").valid&&d.showing_db_custom_password,d.blur()})("ionChange",function(){return t.CHM(s),t.oxw().set_db_custom_password()}),t.qZA(),t.TgZ(14,"ion-button",17),t.NdJ("click",function(){t.CHM(s);const d=t.oxw();return d.showing_db_custom_password=!d.showing_db_custom_password}),t._UZ(15,"ion-icon",18),t._uU(16,"\xa0"),t._UZ(17,"span",13),t.ALo(18,"translate"),t.qZA()(),t.TgZ(19,"div",15),t.YNc(20,y,2,1,"ng-container",10),t.qZA(),t.BQk()}if(2&h){const s=t.oxw();t.xp6(2),t.Q6J("innerHtml",t.lcZ(3,10,"select-server.please-enter-couchdb"),t.oJD),t.xp6(3),t.Q6J("innerHtml",t.lcZ(6,12,"db-server-url"),t.oJD),t.xp6(2),t.Q6J("maxlength",s.E.max_len.url),t.xp6(2),t.Q6J("ngForOf",s.validation_messages.db_custom_server_url),t.xp6(2),t.Q6J("innerHtml",t.lcZ(12,14,"db-pw"),t.oJD),t.xp6(2),t.Q6J("type",s.showing_db_custom_password?"text":"password")("maxlength",s.E.max_len.name),t.xp6(2),t.Q6J("name",s.showing_db_custom_password?"eye-off-outline":"eye-outline"),t.xp6(2),t.Q6J("innerHtml",t.lcZ(18,16,s.showing_db_custom_password?"hide":"show"),t.oJD),t.xp6(3),t.Q6J("ngForOf",s.validation_messages.db_custom_password)}}let G=(()=>{class h{constructor(s,x){this.formBuilder=s,this.G=x,this.E=u.N,this.Object=Object,this.validation_messages={db_custom_server_url:[{type:"required",message:"validation.db-server-url-required"},{type:"pattern",message:"validation.db-server-url-pattern"}],db_custom_password:[{type:"required",message:"validation.db-pw-required"}]}}ngOnInit(){this.G.L.entry("SelectServerComponent.ngOnInit"),this.selectServerFormGroup=this.formBuilder.group({db:new m.NI("settings"==this.page?"central":"default",m.kI.required),db_from_pid:new m.NI("TODO",m.kI.required),db_custom_server_url:new m.NI("",m.kI.pattern(this.G.urlRegex)),db_custom_password:new m.NI("",m.kI.required)}),this.showing_db_custom_password=!1,this.page_object&&this.page_object.onSelectServerReady(this)}blur(){}set_db(){let s=this.selectServerFormGroup.get("db");s.valid&&""!=s.value&&s.value&&this.page_object.set_db(s.value)}set_db_from_pid(){let s=this.selectServerFormGroup.get("db_from_pid");s.valid&&this.page_object.set_db_from_pid(s.value)}set_db_custom_server_url(){let s=this.selectServerFormGroup.get("db_custom_server_url");s.valid&&this.page_object.set_db_custom_server_url(s.value)}set_db_custom_password(){let s=this.selectServerFormGroup.get("db_custom_password");s.valid&&this.page_object.set_db_custom_password(s.value)}}return h.\u0275fac=function(s){return new(s||h)(t.Y36(m.qu),t.Y36(l.U))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-select-server"]],inputs:{page:"page",page_object:"page_object"},decls:16,vars:24,consts:[[3,"formGroup"],["position","floating","color","primary",3,"innerHtml"],["formControlName","db",3,"cancelText","okText","ionChange"],["value","default",3,"innerHtml",4,"ngIf"],["value","central",3,"innerHtml"],["value","poll",3,"innerHtml"],["value","other",3,"innerHtml"],[4,"ngIf"],["value","default",3,"innerHtml"],["formControlName","db_from_pid",2,"font-size","smaller",3,"cancelText","okText","ionChange"],[4,"ngFor","ngForOf"],[3,"value","innerHtml",4,"ngIf"],[3,"value","innerHtml"],[3,"innerHtml"],["type","text","formControlName","db_custom_server_url","required","","debounce","100",2,"font-size","smaller",3,"maxlength","ionChange"],[1,"validation-errors"],["formControlName","db_custom_password","required","","clearOnEdit","false","clearInput","true","debounce","100",2,"font-size","smaller",3,"type","maxlength","keydown.enter","keydown.tab","ionChange"],["slot","end","fill","clear","color","primary",2,"padding-top","10px",3,"click"],["tabindex","-1",3,"name"],["class","error-message",3,"innerHtml",4,"ngIf"],[1,"error-message",3,"innerHtml"]],template:function(s,x){1&s&&(t.TgZ(0,"form",0)(1,"ion-item"),t._UZ(2,"ion-label",1),t.ALo(3,"translate"),t.TgZ(4,"ion-select",2),t.NdJ("ionChange",function(){return x.set_db()}),t.ALo(5,"translate"),t.ALo(6,"translate"),t.YNc(7,r,2,3,"ion-select-option",3),t._UZ(8,"ion-select-option",4),t.ALo(9,"translate"),t._UZ(10,"ion-select-option",5),t.ALo(11,"translate"),t._UZ(12,"ion-select-option",6),t.ALo(13,"translate"),t.qZA()(),t.YNc(14,b,8,10,"ng-container",7),t.YNc(15,T,21,18,"ng-container",7),t.qZA()),2&s&&(t.Q6J("formGroup",x.selectServerFormGroup),t.xp6(2),t.Q6J("innerHtml",t.lcZ(3,12,"settings"==x.page?"settings.db-label":"draftpoll.db-label"),t.oJD),t.xp6(2),t.Akn("settings"!=x.page?"font-size: smaller;":""),t.Q6J("cancelText",t.lcZ(5,14,"cancel"))("okText",t.lcZ(6,16,"OK")),t.xp6(3),t.Q6J("ngIf","settings"!=x.page),t.xp6(1),t.Q6J("innerHtml",t.lcZ(9,18,"select-server.central"),t.oJD),t.xp6(2),t.Q6J("innerHtml",t.lcZ(11,20,"settings"==x.page?"select-server.same-as-some-poll":"select-server.same-as-other-poll"),t.oJD),t.xp6(2),t.Q6J("innerHtml",t.lcZ(13,22,"select-server.other"),t.oJD),t.xp6(2),t.Q6J("ngIf","poll"==x.selectServerFormGroup.get("db").value),t.xp6(1),t.Q6J("ngIf","other"==x.selectServerFormGroup.get("db").value))},directives:[m._Y,m.JL,m.sg,f.Ie,f.Q$,f.t9,f.QI,m.JJ,m.u,o.O5,f.n0,o.sg,f.pK,f.j9,m.Q7,m.nD,f.YG,f.gu],pipes:[a.X$],styles:['@charset "UTF-8";']}),h})()},4496:(Q,Z,i)=>{i.d(Z,{m:()=>o});var m=i(6362),u=i(3926),t=i(587),l=i(8139),f=i(260);let o=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=f.oAB({type:a}),a.\u0275inj=f.cJS({imports:[[m.ez,u.Pc,t.u5,t.UX,l.aw.forChild()]]}),a})()},8921:(Q,Z,i)=>{i.d(Z,{m:()=>u});const u=(0,i(5099).fo)("Share",{web:()=>i.e(3656).then(i.bind(i,3656)).then(t=>new t.ShareWeb)})},6692:(Q,Z,i)=>{i.d(Z,{c:()=>l});var m=i(2752),u=i(9137),t=i(3443);const l=(f,o)=>{let a,r;const e=(_,D,v)=>{if("undefined"==typeof document)return;const y=document.elementFromPoint(_,D);y&&o(y)?y!==a&&(b(),n(y,v)):b()},n=(_,D)=>{a=_,r||(r=a);const v=a;(0,m.c)(()=>v.classList.add("ion-activated")),D()},b=(_=!1)=>{if(!a)return;const D=a;(0,m.c)(()=>D.classList.remove("ion-activated")),_&&r!==a&&a.click(),a=void 0};return(0,t.createGesture)({el:f,gestureName:"buttonActiveDrag",threshold:0,onStart:_=>e(_.currentX,_.currentY,u.a),onMove:_=>e(_.currentX,_.currentY,u.b),onEnd:()=>{b(!0),(0,u.h)(),r=void 0}})}},8714:(Q,Z,i)=>{i.d(Z,{a:()=>t,d:()=>l});var m=i(1670),u=i(1715);const t=function(){var f=(0,m.Z)(function*(o,a,r,e,n){if(o)return o.attachViewToDom(a,r,n,e);if("string"!=typeof r&&!(r instanceof HTMLElement))throw new Error("framework delegate is missing");const b="string"==typeof r?a.ownerDocument&&a.ownerDocument.createElement(r):r;return e&&e.forEach(_=>b.classList.add(_)),n&&Object.assign(b,n),a.appendChild(b),yield new Promise(_=>(0,u.c)(b,_)),b});return function(a,r,e,n,b){return f.apply(this,arguments)}}(),l=(f,o)=>{if(o){if(f)return f.removeViewFromDom(o.parentElement,o);o.remove()}return Promise.resolve()}},9137:(Q,Z,i)=>{i.d(Z,{a:()=>t,b:()=>l,c:()=>u,d:()=>o,h:()=>f});const m={getEngine(){const a=window;return a.TapticEngine||a.Capacitor&&a.Capacitor.isPluginAvailable("Haptics")&&a.Capacitor.Plugins.Haptics},available(){return!!this.getEngine()},isCordova:()=>!!window.TapticEngine,isCapacitor:()=>!!window.Capacitor,impact(a){const r=this.getEngine();if(!r)return;const e=this.isCapacitor()?a.style.toUpperCase():a.style;r.impact({style:e})},notification(a){const r=this.getEngine();if(!r)return;const e=this.isCapacitor()?a.style.toUpperCase():a.style;r.notification({style:e})},selection(){this.impact({style:"light"})},selectionStart(){const a=this.getEngine();!a||(this.isCapacitor()?a.selectionStart():a.gestureSelectionStart())},selectionChanged(){const a=this.getEngine();!a||(this.isCapacitor()?a.selectionChanged():a.gestureSelectionChanged())},selectionEnd(){const a=this.getEngine();!a||(this.isCapacitor()?a.selectionEnd():a.gestureSelectionEnd())}},u=()=>{m.selection()},t=()=>{m.selectionStart()},l=()=>{m.selectionChanged()},f=()=>{m.selectionEnd()},o=a=>{m.impact(a)}},1508:(Q,Z,i)=>{i.d(Z,{s:()=>m});const m=r=>{try{if(r instanceof class a{constructor(e){this.value=e}})return r.value;if(!l()||"string"!=typeof r||""===r)return r;const e=document.createDocumentFragment(),n=document.createElement("div");e.appendChild(n),n.innerHTML=r,o.forEach(v=>{const y=e.querySelectorAll(v);for(let T=y.length-1;T>=0;T--){const G=y[T];G.parentNode?G.parentNode.removeChild(G):e.removeChild(G);const h=t(G);for(let A=0;A<h.length;A++)u(h[A])}});const b=t(e);for(let v=0;v<b.length;v++)u(b[v]);const _=document.createElement("div");_.appendChild(e);const D=_.querySelector("div");return null!==D?D.innerHTML:_.innerHTML}catch(e){return console.error(e),""}},u=r=>{if(r.nodeType&&1!==r.nodeType)return;for(let n=r.attributes.length-1;n>=0;n--){const b=r.attributes.item(n),_=b.name;if(!f.includes(_.toLowerCase())){r.removeAttribute(_);continue}const D=b.value;null!=D&&D.toLowerCase().includes("javascript:")&&r.removeAttribute(_)}const e=t(r);for(let n=0;n<e.length;n++)u(e[n])},t=r=>null!=r.children?r.children:r.childNodes,l=()=>{const r=window,e=r&&r.Ionic&&r.Ionic.config;return!e||(e.get?e.get("sanitizerEnabled",!0):!0===e.sanitizerEnabled||void 0===e.sanitizerEnabled)},f=["class","id","href","src","name","slot"],o=["script","style","iframe","meta","link","object","embed"]},1350:(Q,Z,i)=>{i.d(Z,{S:()=>u});const u={bubbles:{dur:1e3,circles:9,fn:(t,l,f)=>{const o=t*l/f-t+"ms",a=2*Math.PI*l/f;return{r:5,style:{top:9*Math.sin(a)+"px",left:9*Math.cos(a)+"px","animation-delay":o}}}},circles:{dur:1e3,circles:8,fn:(t,l,f)=>{const o=l/f,a=t*o-t+"ms",r=2*Math.PI*o;return{r:5,style:{top:9*Math.sin(r)+"px",left:9*Math.cos(r)+"px","animation-delay":a}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(t,l)=>({r:6,style:{left:9-9*l+"px","animation-delay":-110*l+"ms"}})},lines:{dur:1e3,lines:12,fn:(t,l,f)=>({y1:17,y2:29,style:{transform:`rotate(${30*l+(l<6?180:-180)}deg)`,"animation-delay":t*l/f-t+"ms"}})},"lines-small":{dur:1e3,lines:12,fn:(t,l,f)=>({y1:12,y2:20,style:{transform:`rotate(${30*l+(l<6?180:-180)}deg)`,"animation-delay":t*l/f-t+"ms"}})}}},4254:(Q,Z,i)=>{i.d(Z,{c:()=>t,g:()=>f,h:()=>u,o:()=>a});var m=i(1670);const u=(r,e)=>null!==e.closest(r),t=(r,e)=>"string"==typeof r&&r.length>0?Object.assign({"ion-color":!0,[`ion-color-${r}`]:!0},e):e,f=r=>{const e={};return(r=>void 0!==r?(Array.isArray(r)?r:r.split(" ")).filter(n=>null!=n).map(n=>n.trim()).filter(n=>""!==n):[])(r).forEach(n=>e[n]=!0),e},o=/^[a-z][a-z0-9+\-.]*:/,a=function(){var r=(0,m.Z)(function*(e,n,b,_){if(null!=e&&"#"!==e[0]&&!o.test(e)){const D=document.querySelector("ion-router");if(D)return null!=n&&n.preventDefault(),D.push(e,b,_)}return!1});return function(n,b,_,D){return r.apply(this,arguments)}}()}}]);
//# sourceMappingURL=common.9c9412d1233b109c.js.map