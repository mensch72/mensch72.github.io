{"version":3,"mappings":"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","names":["i0","ctx_r5","routes","path","component","constructor","router","route","translate","G","this","window","L","entry","params","subscribe","db_server_url","db_password","pid","poll_password","ngOnInit","ionViewWillEnter","D","page","ionViewDidEnter","ready","onDataReady","debug","P","polls","p","state","warn","navigate","info","Poll","_state","allow_voting","password","init_myvid","connect_to_remote_poll_db","then","set_timeouts","tally_all","exit","ionViewDidLeave","save_state","go_button_clicked","JoinpollPage","selectors","JoinpollPageRoutingModule","RouterModule","JoinpollPageModule","CommonModule","FormsModule","IonicModule","TranslateModule"],"sources":["./src/app/joinpoll/joinpoll.page.html","./src/app/joinpoll/joinpoll-routing.module.ts","./src/app/joinpoll/joinpoll.page.ts","./src/app/joinpoll/joinpoll.module.ts"],"sourcesContent":["<!--\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n-->\n\n<!--\nTODO:\n- update language\n- allow using wand immediately\n-->\n\n<ion-header>\n  <ion-toolbar style=\"padding-right:11px;\">\n    <ion-buttons slot=\"start\">\n      <ion-menu-button></ion-menu-button>\n    </ion-buttons>\n    <ion-title [innerHtml]=\"'joinpoll.-page-title'|translate\"></ion-title>\n    <ion-buttons slot=\"end\">\n\n      <!-- OFFLINE SIGN -->\n      <ng-container *ngIf=\"!window.navigator.onLine\">\n        <ion-icon name=\"cloud-offline-outline\" color=\"grey\"\n          style=\"position: relative; bottom: -1px;\">\n        </ion-icon>\n        <ion-icon name=\"alert-outline\" color=\"grey\">\n        </ion-icon>\n      </ng-container> \n\n      <!-- SYNCING SIGN -->\n      <ion-spinner *ngIf=\"window.navigator.onLine && !ready\" name=\"crescent\" color=\"grey\"></ion-spinner>\n\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content *ngIf=\"!ready\">\n  <ion-item class=\"ion-text-center\" lines=\"none\">\n    <h3>\n      <i [innerHtml]=\"'joinpoll.fetching'|translate\"></i>&nbsp;\n    </h3>\n  </ion-item>\n  <ion-item class=\"ion-text-center\" lines=\"none\">\n    <h1>\n      <ion-spinner name=\"crescent\" size=\"large\"></ion-spinner>\n    </h1>\n  </ion-item>\n</ion-content>\n\n<ion-content *ngIf=\"ready && !p\">\n  <ion-item class=\"ion-text-center\" lines=\"none\">\n    <h3>\n      <i [innerHtml]=\"'joinpoll.initializing'|translate\"></i>&nbsp;\n    </h3>\n  </ion-item>\n  <ion-item class=\"ion-text-center\" lines=\"none\">\n    <h1>\n      <ion-spinner name=\"crescent\" size=\"large\"></ion-spinner>\n    </h1>\n  </ion-item>\n</ion-content>\n\n<ion-content *ngIf=\"ready && (p!=null)\">\n  <ion-item class=\"ion-text-center\" color=\"warning\">\n    <ion-col class=\"ion-no-padding ion-no-margin\">\n      <h4 [innerHtml]=\"'joinpoll.header'|translate:{poll_title:p.title}\"></h4>\n      <p [innerHtml]=\"(p.type=='winner'?'joinpoll.p1-winner':'joinpoll.p1-share')|translate:{due:p.due_string}\"></p>\n    </ion-col>\n  </ion-item>\n  <ion-item class=\"ion-text-center\" color=\"secondary\">\n    <ion-col class=\"ion-no-padding ion-no-margin\">\n      <p [innerHtml]=\"'joinpoll.p2'|translate\"></p>\n    </ion-col>\n  </ion-item>\n  <ion-item class=\"ion-text-center\" color=\"primary\">\n    <ion-col class=\"ion-no-padding ion-no-margin\">\n      <p [innerHtml]=\"'joinpoll.p3'|translate\"></p>\n    </ion-col>\n  </ion-item>\n  <ion-item class=\"ion-text-center\" color=\"light\">\n    <ion-col class=\"ion-no-padding ion-no-margin\">\n      <small>\n        <p [innerHtml]=\"'joinpoll.p4'|translate\"></p>\n      </small>\n    </ion-col>\n  </ion-item>\n  <ion-item class=\"ion-text-center\" lines=\"none\">\n    <ion-col class=\"ion-no-padding ion-no-margin\">\n      <small>\n        <p [innerHtml]=\"'joinpoll.p5'|translate\"></p>\n      </small>\n    </ion-col>\n  </ion-item>\n  <ion-item class=\"ion-text-center\" lines=\"none\">\n    <ion-col class=\"ion-no-padding ion-no-margin\">\n      <ion-button size=\"large\" fill=\"solid\" color=\"primary\" \n          shape=\"round\" type=\"submit\"\n          (click)=\"go_button_clicked()\">\n        <span [innerHtml]=\"'joinpoll.lets-go-button'|translate\"></span>&nbsp;\n        <ion-icon name=\"arrow-forward-outline\"></ion-icon>\n      </ion-button>\n    </ion-col>\n  </ion-item>\n  <ion-item class=\"ion-text-center\" lines=\"none\">\n    <ion-col class=\"ion-no-padding ion-no-margin\">\n      <small>\n        <p [innerHtml]=\"'joinpoll.p6'|translate:{link_start:help_link_start,link_end:help_link_end}\"></p>\n      </small>\n    </ion-col>\n  </ion-item>\n</ion-content>\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { JoinpollPage } from './joinpoll.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: JoinpollPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class JoinpollPageRoutingModule {}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { TranslateService } from '@ngx-translate/core';\n\nimport { GlobalService } from \"../global.service\";\nimport { Poll } from '../poll.service';\n\n@Component({\n  selector: 'app-join',\n  templateUrl: './joinpoll.page.html',\n  styleUrls: ['./joinpoll.page.scss'],\n})\nexport class JoinpollPage implements OnInit {\n\n  window = window;\n\n  help_link_start = '<a href=\"/help\">';\n  help_link_end = '</a>';\n\n  db_server_url: string;\n  db_password: string;\n  pid: string;\n  poll_password: string;\n  p: Poll;\n\n  // LIFECYCLE:\n\n  ready = false;  \n\n  constructor(\n    public router: Router,\n    private route: ActivatedRoute,\n    public translate: TranslateService,\n    public G: GlobalService) {\n    this.G.L.entry(\"JoinpollPage.constructor\");\n    this.route.params.subscribe( params => { \n      this.db_server_url = params['db_server_url'];\n      this.db_password = params['db_password'];\n      this.pid = params['pid'];\n      this.poll_password = params['poll_password'];\n    } );\n  }\n\n  ngOnInit() {\n    this.G.L.entry(\"JoinpollPage.ngOnInit\");\n  }\n\n  ionViewWillEnter() {\n    this.G.L.entry(\"JoinpollPage.ionViewWillEnter\");\n    this.G.D.page = this;\n    // TODO: generate poll object and try connecting via data service\n  }\n\n  ionViewDidEnter() {\n    this.G.L.entry(\"JoinpollPage.ionViewDidEnter\");\n    if (this.G.D.ready) {\n      this.onDataReady();\n    }\n    this.G.L.debug(\"JoinpollPage.ready:\", this.ready);\n    // TODO: either go to voting page directly or show some kind of welcome page?\n  }\n\n  onDataReady() {\n    // called when DataService initialization was slower than view initialization\n    this.G.L.entry(\"JoinpollPage.onDataReady\");\n    if (this.pid in this.G.P.polls) {\n      this.p = this.G.P.polls[this.pid];\n      if (this.p.state == 'draft') {\n        this.G.L.warn(\"JoinpollPage called for draft poll, redirecting to mypolls page\", this.pid);\n        this.router.navigate([\"/mypolls\"]);\n      } else {\n        this.G.L.info(\"JoinpollPage called for known poll, redirecting to polls page\", this.pid);\n        this.router.navigate([\"/poll/\" + this.pid]);\n      }\n    } else {\n      this.G.L.info(\"JoinpollPage called for unknown pid, trying to connect\", this.pid);\n      this.p = new Poll(this.G, this.pid);\n      this.p._state = \"running\";\n      this.p.allow_voting = true;\n      this.p.db_server_url = this.db_server_url;\n      this.p.db_password = this.db_password;\n      this.p.password = this.poll_password;\n      this.p.init_myvid();\n      this.G.D.connect_to_remote_poll_db(this.pid, true).then(() => {\n        // remote poll db has been replicated completely to local poll db\n        this.ready = true;\n        this.p.set_timeouts();\n        this.p.tally_all();\n      });\n    }\n    this.G.L.exit(\"JoinpollPage.onDataReady\");\n  }\n\n  ionViewDidLeave() {\n    this.G.L.entry(\"JoinpollPage.ionViewDidLeave\");\n    this.G.D.save_state();\n    this.G.L.exit(\"JoinpollPage.ionViewDidLeave\");\n  }\n\n  go_button_clicked() {\n    this.router.navigate([\"/poll/\" + this.pid]);\n  }\n}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK), authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { JoinpollPageRoutingModule } from './joinpoll-routing.module';\n\nimport { JoinpollPage } from './joinpoll.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    JoinpollPageRoutingModule,\n    TranslateModule.forChild()\n  ],\n  declarations: [JoinpollPage]\n})\nexport class JoinpollPageModule {}\n"],"sourceRoot":"webpack:///","file":"2172.1320b9e312abef55.js"}